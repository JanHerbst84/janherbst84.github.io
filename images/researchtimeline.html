<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research Projects Timeline</title>
    <style>
        body {
            font-family: 'Georgia', serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }
        .container {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .timeline-container {
            position: relative;
            margin: 30px 0;
        }
        canvas {
            border: 1px solid #ddd;
            background-color: white;
        }
        .controls {
            margin: 20px 0;
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        button {
            padding: 8px 15px;
            background-color: #4a6fa5;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #3a5a80;
        }
        .legend {
            margin-top: 20px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 4px;
        }
        .project-details {
            margin-top: 30px;
        }
        .project-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .project-item h3 {
            margin-bottom: 5px;
            color: #4a6fa5;
        }
        .project-dates {
            font-style: italic;
            color: #666;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Research Projects Timeline</h1>
        
        <div class="timeline-container">
            <canvas id="timelineCanvas" width="1100" height="600"></canvas>
        </div>
        
        <div class="controls">
            <button id="zoomIn">Zoom In</button>
            <button id="zoomOut">Zoom Out</button>
            <button id="panLeft">← Pan Left</button>
            <button id="panRight">Pan Right →</button>
            <button id="reset">Reset View</button>
        </div>
        
        <div class="legend">
            <h3>Legend</h3>
            <div id="legendItems"></div>
        </div>
        

    </div>

    <script>
        // Define your research projects here
        const projects = [
            {
                id: 1,
                title: "Popular Music Education",
                startDate: new Date(2011, 0, 1), // Jan 1, 2011
                endDate: new Date(2014, 11, 31),  // Dec 31, 2014
                description: "",
                color: "#4a6fa5"
            },
            {
                id: 2,
                title: "The Electric Guitar",
                startDate: new Date(2014, 0, 1), // Jan 1, 2014
                endDate: new Date(2024, 11, 31),  // Dec 31, 2024
                description: "",
                color: "#e28743"
            },
            {
                id: 3,
                title: "German Heavy Metal",
                startDate: new Date(2017, 0, 1), // Jan 1, 2017
                endDate: new Date(2022, 11, 31),  // Dec 31, 2022
                description: "",
                color: "#76a56f"
            },
            {
                id: 4,
                title: "Gear Acquisition Syndrome",
                startDate: new Date(2018, 0, 1), // Jan 1, 2018
                endDate: new Date(2021, 11, 31), // Dec 31, 2021
                description: "",
                color: "#9c6fb0"
            },
            {
                id: 5,
                title: "Heaviness in Metal Music Production",
                startDate: new Date(2020, 0, 1), // Jan 1, 2020
                endDate: null, // Ongoing
                description: "",
                color: "#d16666"
            },
            {
                id: 6,
                title: "Web 3 and AI in Music",
                startDate: new Date(2022, 0, 1), // Jan 1, 2022
                endDate: null, // Ongoing
                description: "",
                color: "#3ca3a3"
            },
            {
                id: 7,
                title: "Songwriting Camps in the 21st Century",
                startDate: new Date(2023, 0, 1), // Jan 1, 2023
                endDate: null, // Ongoing
                description: "",
                color: "#c98f30"
            }
        ];

        // Canvas setup
        const canvas = document.getElementById('timelineCanvas');
        const ctx = canvas.getContext('2d');
        const legendContainer = document.getElementById('legendItems');


        // Initialize minimal offset to show the entire timeline
        let scale = 1;
        let offsetX = 0;
        
        // Calculate earliest and latest dates from projects
        const minDate = new Date(Math.min(...projects.map(p => p.startDate.getTime())));
        // For max date, account for ongoing projects
        const now = new Date();
        const maxDate = new Date(Math.max(...projects.map(p => p.endDate ? p.endDate.getTime() : now.getTime())));
        
        // Add some padding (6 months) to the date range for better visualization
        minDate.setMonth(minDate.getMonth() - 6);
        maxDate.setMonth(maxDate.getMonth() + 6);
        
        // Initial setup
        createLegend();
        drawTimeline();

        // Event listeners for controls
        document.getElementById('zoomIn').addEventListener('click', () => {
            scale = Math.min(3, scale * 1.2); // Limit maximum zoom
            drawTimeline();
        });
        
        document.getElementById('zoomOut').addEventListener('click', () => {
            scale = Math.max(0.5, scale / 1.2); // Limit minimum zoom
            drawTimeline();
        });
        
        document.getElementById('panLeft').addEventListener('click', () => {
            offsetX -= 100 / scale; // Adjust pan amount based on zoom level
            drawTimeline();
        });
        
        document.getElementById('panRight').addEventListener('click', () => {
            offsetX += 100 / scale; // Adjust pan amount based on zoom level
            drawTimeline();
        });
        
        document.getElementById('reset').addEventListener('click', () => {
            scale = 1;
            offsetX = 0;
            drawTimeline();
        });

        // Canvas interaction for hover effects
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            let isOverProject = false;
            
            // Check if mouse is over a project bar
            for (let i = 0; i < projects.length; i++) {
                const project = projects[i];
                const projectY = 80 + i * 70; // Match the new spacing in drawTimeline
                
                if (y >= projectY && y <= projectY + 40) {
                    // Calculate project's position on the timeline
                    const projectStartX = getXPosition(project.startDate);
                    const projectEndX = project.endDate ? getXPosition(project.endDate) : getXPosition(new Date());
                    
                    if (x >= projectStartX && x <= projectEndX) {
                        canvas.style.cursor = 'pointer';
                        isOverProject = true;
                        break;
                    }
                }
            }
            
            if (!isOverProject) {
                canvas.style.cursor = 'default';
            }
        });

        function getXPosition(date) {
            const totalDays = (maxDate - minDate) / (1000 * 60 * 60 * 24);
            const daysFromStart = (date - minDate) / (1000 * 60 * 60 * 24);
            const pixelsPerDay = (canvas.width - 100) / totalDays;
            
            // Apply scale and offset while ensuring the result stays within reasonable bounds
            return Math.min(Math.max(50, 50 + (daysFromStart * pixelsPerDay * scale) + offsetX), canvas.width - 50);
        }

        function drawTimeline() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw timeline axis
            ctx.beginPath();
            ctx.moveTo(50, 50);
            ctx.lineTo(canvas.width - 50, 50);
            ctx.stroke();
            
            // Draw year markers
            const startYear = minDate.getFullYear();
            const endYear = maxDate.getFullYear() + 1;
            
            for (let year = startYear; year <= endYear; year++) {
                const yearDate = new Date(year, 0, 1);
                const x = getXPosition(yearDate);
                
                if (x >= 50 && x <= canvas.width - 50) {
                    ctx.beginPath();
                    ctx.moveTo(x, 45);
                    ctx.lineTo(x, 55);
                    ctx.stroke();
                    
                    ctx.fillStyle = "#333";
                    ctx.textAlign = "center";
                    ctx.fillText(year, x, 40);
                }
                
                // Draw mid-year markers
                const midYearDate = new Date(year, 6, 1);
                const midX = getXPosition(midYearDate);
                
                if (midX >= 50 && midX <= canvas.width - 50) {
                    ctx.beginPath();
                    ctx.moveTo(midX, 47);
                    ctx.lineTo(midX, 53);
                    ctx.stroke();
                }
            }
            
            // Draw projects
            projects.forEach((project, index) => {
                const y = 80 + index * 70; // Increased vertical spacing between projects
                let startX = getXPosition(project.startDate);
                let endX = project.endDate ? getXPosition(project.endDate) : getXPosition(new Date());
                
                // Ensure minimum width for very short or zero-width bars
                if (endX - startX < 5) {
                    endX = startX + 5;
                }
                
                // Draw project bar
                ctx.fillStyle = project.color;
                ctx.fillRect(startX, y, endX - startX, 40);
                
                // Add project title with text wrapping if needed
                const title = project.title;
                const barWidth = endX - startX;
                
                // Measure text width for positioning
                ctx.font = "bold 12px Georgia";
                const textWidth = ctx.measureText(title).width;
                const textHeight = 15; // Approximate height of text
                
                // Determine text position based on available space
                let textX, textY;
                let textColor;
                
                // Check if text fits inside the bar
                if (barWidth > textWidth + 20 && barWidth > 100) {
                    // Text inside the bar
                    textX = startX + 10;
                    textY = y + 24;
                    textColor = "#fff";
                } 
                // Check if text fits to the right of the bar
                else if (endX + textWidth + 15 < canvas.width) {
                    // Text after the bar
                    textX = endX + 10;
                    textY = y + 24;
                    textColor = "#333";
                } 
                // Text above the bar
                else {
                    textX = Math.max(50, startX);
                    textY = y - 10;
                    textColor = "#333";
                }
                
                // Draw text with background for better readability
                if (textColor === "#333") {
                    // For dark text, add a semi-transparent white background
                    // Add extra padding to ensure text isn't cut off
                    ctx.fillStyle = "rgba(255, 255, 255, 0.85)";
                    ctx.fillRect(textX - 3, textY - textHeight + 2, textWidth + 6, textHeight + 4);
                }
                
                // Draw text
                ctx.fillStyle = textColor;
                ctx.fillText(title, textX, textY);
                
                // Add start and end dates with better positioning
                ctx.font = "10px Georgia";
                
                const startDateText = formatDate(project.startDate);
                const endDateText = project.endDate ? formatDate(project.endDate) : "Ongoing";
                
                const startDateWidth = ctx.measureText(startDateText).width;
                const endDateWidth = ctx.measureText(endDateText).width;
                
                // Position dates with better spacing
                // Start date - ensure it's always visible and not cut off
                const startDateX = Math.max(50, startX - startDateWidth/2);
                ctx.fillStyle = "rgba(255, 255, 255, 0.85)";
                ctx.fillRect(startDateX - 3, y - 15, startDateWidth + 6, 12);
                
                ctx.fillStyle = "#333";
                ctx.fillText(startDateText, startDateX, y - 5);
                
                // End date - position it properly for visibility
                const endDateX = Math.min(canvas.width - 50, endX - endDateWidth/2);
                ctx.fillStyle = "rgba(255, 255, 255, 0.85)";
                ctx.fillRect(endDateX - 3, y - 15, endDateWidth + 6, 12);
                
                ctx.fillStyle = "#333";
                ctx.fillText(endDateText, endDateX, y - 5);
            });
        }

        function createLegend() {
            let legendHTML = '';
            
            projects.forEach(project => {
                legendHTML += `
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 20px; height: 20px; background-color: ${project.color}; margin-right: 10px;"></div>
                        <span>${project.title}</span>
                    </div>
                `;
            });
            
            legendContainer.innerHTML = legendHTML;
        }

        function createProjectsList() {
            let projectsHTML = '';
            
            projects.forEach(project => {
                const endDateText = project.endDate ? formatDate(project.endDate) : "Ongoing";
                
                projectsHTML += `
                    <div class="project-item" id="project-${project.id}">
                        <h3>${project.title}</h3>
                        <div class="project-dates">${formatDate(project.startDate)} — ${endDateText}</div>
                    </div>
                `;
            });
            
            projectsListContainer.innerHTML = projectsHTML;
        }

        function highlightProject(projectId) {
            // Reset all projects
            document.querySelectorAll('.project-item').forEach(item => {
                item.style.backgroundColor = '';
                item.style.padding = '';
                item.style.borderRadius = '';
            });
            
            // Highlight selected project
            const projectElement = document.getElementById(`project-${projectId}`);
            projectElement.style.backgroundColor = '#f0f5fa';
            projectElement.style.padding = '10px';
            projectElement.style.borderRadius = '4px';
            
            // Scroll to the project details
            projectElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function formatDate(date) {
            const month = date.toLocaleString('default', { month: 'short' });
            const year = date.getFullYear();
            return `${month} ${year}`;
        }
    </script>
</body>
</html>